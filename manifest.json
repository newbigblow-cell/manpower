async function registerDevice() {
    const staffId = document.getElementById('staffId').value.trim();
    
    if (!staffId) {
        showError("Please enter your Staff ID");
        return;
    }

    try {
        // Use GET request with query parameter
        const response = await fetch(`https://your-n8n-domain.com/staff-registration?staffId=${encodeURIComponent(staffId)}`, {
            method: 'GET', // Changed to GET
            headers: { 
                'Content-Type': 'application/json' 
            }
            // No body for GET requests
        });

        const result = await response.json();

        if (result.success) {
            localStorage.setItem('deviceToken', result.newToken);
            localStorage.setItem('staffId', result.staffId);
            localStorage.setItem('staffName', result.staffName);
            
            showSuccess("Device registered successfully!");
            setTimeout(() => showMainApp(), 2000);
        } else {
            if (result.error === "ALREADY_REGISTERED") {
                showError("This Staff ID is already registered with another device.");
                document.getElementById('admin-contact').style.display = 'block';
            } else {
                showError(result.message);
            }
        }
    } catch (error) {
        showError("Network error. Please try again.");
    }
}
